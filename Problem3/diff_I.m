% [0.00188506486977532] 7.5mA
% [0.00142986516783244] 5.5mA
% [0.000912192074555391] 3.5mA
% [0.00226273619360116] 9.5mA
% [0.00248755827037337] 11.5mA
% [0.00245804892391669] 13.5mA
%[0.00104662803041595] 4mA
%[0.00117786747508493] 4.5mA
%[0.00130568732297006] 5mA
%[0.000200783430690688] 1mA
clear;
clc;
p = [0.00104662803041595,0.00117786747508493,0.00130568732297006,0.00142986516783244,0.00188506486977532,0.00226273619360116,0.00248755827037337,0.00245804892391669];
% [0.000634674686819735]
% [0.000774791815863139]
% [0.000912192074555391]
% [0.00104662803041595]
%p = [0.000774791815863139, 0.000912192074555391,0.00104662803041595];
load('c.mat');
load('S21_5.mat')

S21 = ones(2500,8);
cmap=colormap(jet(8)); 
for i = 1 : 8
    p0 = p(i);
    Ns = (p0 /c(4)*c(7) + c(5)*c(6)*p0 /(c(4) + c(8)*p0)) / (c(2)/c(3) + c(5)*p0/(c(4) + c(8)*p0));
    Y = 1/c(7) + 1/c(3) + c(5)*p0/(c(4) + c(8)*p0) - c(5)*(Ns-c(6))/((1+c(8)*p0/c(4))^2);
    Z = 1/(c(7)*c(3)) + c(5)*p0/((c(4) + c(8)*p0)*c(7)) - (((1-c(2))/c(3)))*c(5)*(Ns-c(6))/((1+c(8)*p0/c(4))^2);
    S21(:,i) = 20*log10(Z./((Z - 4*pi^2*f.^2).^2 + 4*pi^2*f.^2*Y^2).^0.5);
    plot(f/1e9,S21(:,i),'Color',cmap(i,:))
    hold on
end
legend('4.0mA','4.5mA','5mA','5.5mA','7.5mA','9.5mA','11.5mA','13.5mA')
%legend('1','2','3')
xlabel('f/GHz')
ylabel('H/DB')
grid on 
title('温度为20℃时不同偏置电流的频率响应图')